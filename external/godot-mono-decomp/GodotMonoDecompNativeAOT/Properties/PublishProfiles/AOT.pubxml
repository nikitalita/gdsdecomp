<?xml version="1.0" encoding="utf-8"?>
<!--
https://go.microsoft.com/fwlink/?LinkID=208121.
-->
<Project>
	<PropertyGroup>
		<PublishTrimmed>true</PublishTrimmed>
		<PublishAot>true</PublishAot>
		<SelfContained>true</SelfContained>
	</PropertyGroup>
	<Target Name="CustomActionsAfterPublish" AfterTargets="Publish">
<!--		If the platform is not windows, copy the library to `lib<LIBRARY_NAME>`-->
		<Exec Command="cp $(PublishDir)$(TargetName).dylib $(PublishDir)lib$(TargetName).dylib" Condition=" '$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::OSX)))' "/>
		<Exec Command="cp $(PublishDir)$(TargetName).so $(PublishDir)lib$(TargetName).so" Condition=" '$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Linux)))' "/>
		<!-- if on windows, copy the .lib and .exp files from the $(PublishDir)/../native folder to the $(PublishDir) folder -->
		<!-- make sure it runs with powershell -->
		<Exec Command="powershell -Command &quot;cp $(PublishDir)../native/*.lib $(PublishDir) &quot;" Condition=" '$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Windows)))' "/>
		<Exec Command="powershell -Command &quot;cp $(PublishDir)../native/*.exp $(PublishDir) &quot;" Condition=" '$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::Windows)))' "/>
		<!-- if we're on macos, run install_name_tool to change the library path -->
		<Exec Command="install_name_tool -id @rpath/lib$(TargetName).dylib $(PublishDir)lib$(TargetName).dylib" Condition=" '$([System.Runtime.InteropServices.RuntimeInformation]::IsOSPlatform($([System.Runtime.InteropServices.OSPlatform]::OSX)))' "/>
	</Target>
</Project>
